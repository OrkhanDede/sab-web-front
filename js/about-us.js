const aboutCompanySlide = [
  {
    description: {
      az: `
          <b> “SAB” </b> brendi 1998-ci ildə yaradılmış “Zəhmət-Ruzi” MMC-nin bir hissəsidir və yüksək 
          keyfiyyətli ət və süd məhsulları istehsalı, həmçinin onların emalı ilə məşğuldur. </br> </br> 
          Şirkətimiz ölkəmizdə kolbasa, süd məhsulları və delikateslərin istehsalı 
          sahəsində təxminən 15%-lik bazar payı ilə aparıcı mövqeyə malikdir.`,
      en: `
          <b> “SAB” </b> brand is a part of “Zahmat-Ruzi” LLC, which was founded in 1998 and produces 
          high-quality meat and milk as well as provide their processing.  </br> </br> 
          Our company occupies a leading position in the production of sausages, milk, and delicacies in 
          our country with about 15% market share.`,
    },
  },
  {
    description: {
      az: `
          Biz yalnız halal inqrediyentlərdən hazırlanan yüksək keyfiyyətli ət və süd məhsulları istehsal edirik. </br> </br> 
          Həmçinin, soyuducu saxlama, qablaşdırma və laboratoriya analiz xidmətləri göstəririk.`,
      en: `
          We produce high-quality meat and dairy products, made of Halal only ingredients. </br> </br> 
          Also, we provide fridge storage, packaging and laboratory analysis services.`,
    },
  },
  {
    description: {
      az: `
          Xırdalan rayoundakı fabrikimiz ən müasir istehsal avadanlıqları, laboratoriyalar, anbarlar və nəqliyyat sistemləri ilə təchiz olunub.  </br> </br> 
          İstehsal demək olar ki, tam avtomatlaşdırılıb və avadanlıqlarımız Almaniya, İtaliya və Polşadan gətirilib.`,
      en: `
          Our factory in Khirdalan city is equipped with the most up-to-date production facilities, laboratories, warehouses, and transportation systems. </br> </br> 
          The production is almost fully automated and our equipment is brought from Germany, Italy, and Poland.`,
    },
  },
];

const historySlide = [
  {
    year: 1998,
    description: {
      en: `Sabir Babayev founded "Zahmat-Ruzi" LLC and opens the first factory of the company at 111 Heydar Aliyev avenue, 
      Narimanov district, Baku. The enthusiastic welcome of buyers in the early stages of their products gives a strong impetus to future work.`,

      az: `
      Sabir Babayev "Zəhmət-Ruzi" MMC-ni təsis edir və şirkətin Bakı şəhəri Nərimanov rayonu, Heydər Əliyev prospekti 111
       ünvanında ilk zavodu açılır. Elə ilk dövrlərdəcə istehsal edilən məhsulların alıcılar tərəfindən rəğbətlə 
       qarşılanması gələcək işlərə böyük stimul verir.`,
    },
  },
  {
    year: 2002,
    description: {
      en: `
      “Zahmat-Ruzi” LLC is already beginning to produce its products under the trademark “SAB”. 
      The word "SAB" is derived from the first letters of the name and father’s name of the founder of 
      the company, Sabir Atamali Babayev.`,
      az: `
      “Zəhmət-Ruzi” MMC artıq öz məhsullarını “SAB” ticarət nişanı altında istehsal etməyə başlayır. 
      “SAB” sözünün açıqlaması şirkətin qurucusu olan Sabir Atəməli oğlu Babayevin ad, soyad və 
      atasının adının ilk hərflərindən götürülmüşdür.`,
    },
  },
  {
    year: 2012,
    description: {
      en: `
      Zahmat-Ruzi LLC is building a new factory on 3 hectares in the new address –Khirdalan city, 
      academic Hasan Aliyev Street 38, and the thus production process will be moved to this factory. 
      The factory, laboratories, production shops, and warehouses are equipped with the most modern equipment, 
      transportation systems are reconstructed.`,
      az: `
      "Zəhmət-Ruzi" MMC yeni ünvanda - Xırdalan şəhəri, akademik Həsən Əliyev küçəsi, 38-də 3 hektar 
      ərazidə müasir zavod tikilir və istehsal həmin zavoda köçürülür. Zavodda laboratoriyalar, 
      istehsal sexləri və anbar ən müasir avadanlıqlarla təchiz edilir, daşınma sistemləri yenidən qurulur.`,
    },
  },
  {
    year: 2014,
    description: {
      en: `
     SAB products are awarded the Gold Medal of the international “Moscow Halal - Expo – 2014”. 
     Besides, the company is fully certified in 2014 by the State Committee on Standardization 
     Metrology and Patents. Besides, SAB is the only brand guaranteed by the Caucasian Muslims Office.`,
      az: `
      "SAB" məhsulları "Moscow Halal - Expo - 2014" beynəlxalq qida sərgisinin qızıl medalına layiq görülür. 
      Bundan başqa şirkət 2014-cü ildə Standartlaşma Metrologiya və Patent üzrə Dövlət Komitəsi tərəfindən 
      tam sertifikatlaşdırılır. Bundan başqa "SAB" Qafqaz Müsəlmanları İdarəsinin halallıq zəmanəti verdiyi yeganə brenddir.`,
    },
  },
  {
    year: 2015,
    description: {
      en: `
      Products won the Grand Prix Prize at the Food Exhibition in Kazakhstan and a gold medal at the Moscow Halal Expo-2015 for the second time.`,
      az: `
      Məhsullar Qazaxıstanda keçirilən qida sərgisinin əsas mükafatı olan "Qrand Prix" mükafatını və ikinci dəfə "Moscow Halal - Expo - 2015" sərgisinin qızıl medalını qazandı.`,
    },
  },
  {
    year: 2016,
    description: {
      en: `
      SAB is awarded the Platinium mark of the Azerbaijan Consumer Food Safety label (AICTN Quality Mark), 
      established by the Free Consumers Union, with the support of USAID. The brand is also awarded a gold 
      medal at the Moscow Halal - Expo - 2016 for high-quality products.`,
      az: `
      "SAB" ticarət nişanı USAİD Təşkilatının dəstəyi ilə Azad İstehlakçılar Birliyinin təsis etdiyi "Azərbaycan İstehlakçılarının 
      Qida Təhlükəsizliyi nişanı"nın (AİQTN Keyfiyyət Nişanı) "Platinium" nişanına layiq görülür. Həmçinin brend 
      yüksək keyfiyyətli məhsullara görə "Moscow Halal - Expo - 2016" sərgisində yenidən qızıl medalla mükafatlandırılır.`,
    },
  },
  {
    year: 2017,
    description: {
      en: `
      On November 16, 2017, President of the Republic of Azerbaijan Ilham Aliyev reviewed the activities of 
      “Zahmat-Ruzi” LLC in Absheron. President Ilham Aliyev will present 60 kinds of meat and 40 types 
      of dairy products under the brand SAB - Made In Azerbaijan.`,
      az: `
      Azərbaycan Respublikasının Prezidenti İlham Əliyev 16 noyabr 2017-ci il tarixində Abşeron rayonunda “Zəhmət-Ruzi” 
      MMC-nin fəaliyyəti ilə tanış olur. Prezident İlham Əliyevin diqqətinə “SAB” – “Made In Azerbaijan” 
      markası ilə bazarlara çıxarılan 60 növ ət və 40 növ süd məhsullarının nümunələri təqdim edilir.`,
    },
  },
];

document.addEventListener("DOMContentLoaded", () => {
  const isMobile = document.body.clientWidth <= 991 ? 1 : 0;

  slideMounted = false;
  var splide = new Splide(".splide", {
    type: "loop",
    gap: "2rem",
    autoplay: true,
    pauseOnHover: false,
    pauseOnFocus: false,
    resetProgress: false,
    padding: { right: "5rem", left: "0" },
    easing: "ease",
    pagination: true,
    arrows: true,
    breakpoints: {
      991: {
        padding: { right: "15rem", left: "0" },
      },
    },
  });

  var historySplide = new Splide(".history-splide", {
    type: "fade",
    autoplay: true,
    rewind: true,
    pagination: false,
  });

  var yearSplide = new Splide(".year-splide", {
    perPage: 6,
    perMove: 1,
    gap: "2rem",
    arrows: false,
    pagination: false,
    breakpoints: {
      991: {
        perPage: 4,
      },
      768: {
        perPage: 3,
      },
      400: {
        perPage: 2,
      },
    },
  });
  let swiperInstance;

  function updateSlideContent(index, id, slideName, yearElementId = null) {
    const descriptionElement = document.getElementById(id);
    const yearElement = document.getElementById(yearElementId);

    const currentLang = localStorage.getItem("language");
    const newLang = currentLang === "en" ? "en" : "az";

    descriptionElement.innerHTML = slideName[index].description[newLang];
    if (yearElement) {
      yearElement.innerHTML = slideName[index].year;
    }
  }

  updateSlideContent(0, "slide-description", aboutCompanySlide);
  updateSlideContent(
    0,
    "slide-description-history",
    historySlide,
    "slide-description-year"
  );

  splide.on("moved", function (newIndex) {
    updateSlideContent(newIndex, "slide-description", aboutCompanySlide);
  });

  historySplide.on("moved", function (newIndex) {
    updateSlideContent(
      newIndex,
      "slide-description-history",
      historySlide,
      "slide-description-year"
    );

    yearSplide.go(newIndex);
    updateActiveYear(newIndex);
  });

  yearSplide.on("moved", function (newIndex) {
    updateSlideContent(
      newIndex,
      "slide-description-history",
      historySlide,
      "slide-description-year"
    );
    updateActiveYear(newIndex);
  });

  function updateActiveYear(activeIndex) {
    const yearItems = document.querySelectorAll(".year-splide .year-item");

    yearItems.forEach((item, index) => {
      if (index === activeIndex) {
        item.classList.add("text-secondary", "border-primary");
        item.classList.remove("text-[#8C8C8C]", "border-[#BCBCBC]");
      } else {
        item.classList.remove("text-secondary", "border-primary");
        item.classList.add("text-[#8C8C8C]", "border-[#BCBCBC]");
      }
    });
  }

  function addYearItemClickEvents() {
    const yearItems = document.querySelectorAll(".year-splide .year-item");

    yearItems.forEach((item, index) => {
      item.addEventListener("click", function () {
        historySplide.go(index);
        yearSplide.go(index);

        updateActiveYear(index);
      });
    });
  }

  addYearItemClickEvents();

  function mountSlide(slideName, customPaginationId, customArrowServiceId) {
    slideName.on("mounted", function () {
      var paginationItems = slideName.Components.Pagination.items;
      var customPagination = document.getElementById(customPaginationId);

      var prevArrow = slideName.Components.Arrows.arrows.prev;
      var nextArrow = slideName.Components.Arrows.arrows.next;
      var customArrows = document.getElementById(customArrowServiceId);

      var prevIcon = document.createElement("img");
      prevIcon.src = "/assets/icons/splide-arrow-left.svg";
      prevIcon.alt = "Previous";

      var nextIcon = document.createElement("img");
      nextIcon.src = "/assets/icons/splide-arrow-right.svg";
      nextIcon.alt = "Next";

      prevArrow.innerHTML = "";
      nextArrow.innerHTML = "";

      prevArrow.appendChild(prevIcon);
      nextArrow.appendChild(nextIcon);

      if (customPagination) {
        paginationItems.forEach(function (item) {
          customPagination.appendChild(item.button);
        });
      }
      if (customArrows) {
        customArrows.appendChild(prevArrow);
        customArrows.appendChild(nextArrow);
      }
    });
  }

  mountSlide(splide, "splide_custom_pagination", "custom_arrows_services");
  mountSlide(
    historySplide,
    "splide_custom_pagination_history",
    "custom_arrows_services_history"
  );

  splide.mount();
  historySplide.mount();
  yearSplide.mount();

  new fullpage("#fullpage", {
    autoScrolling: true,

    afterLoad: function (origin, destination, direction) {
      const section = destination.index;

      // if (section === 2 && !slideMounted) {
      //   slideMounted = true;
      //   historySplide.mount();
      //   yearSplide.mount();
      // }
      if (section === 4 + +isMobile && !swiperInstance) {
        swiperInstance = new Swiper(".swiper-container", {
          effect: "coverflow",
          grabCursor: true,
          centeredSlides: true,
          slidesPerView: 3,
          loop: true,
          autoplay: {
            delay: 5000,
            disableOnInteraction: false,
          },
          coverflowEffect: {
            rotate: 0,
            stretch: 0,
            depth: 250,
            modifier: 1,
            slideShadows: false,
          },
          navigation: {
            prevEl: ".certificate-button-prev",
            nextEl: ".certificate-button-next",
          },
          pagination: false,
          breakpoints: {
            100: {
              slidesPerView: 2,
            },
            991: {
              slidesPerView: 3,
            },
          },
        });
      }
    },
  });

  const meatImage = document.getElementById("meat-image");
  const mobileMeatSectionBanner = document.getElementById(
    "mobileMeatSectionBanner"
  );
  const defaultImageSrc = "/assets/images/about-us/meet.jpg";
  const defaultTextClass = "text-secondary";
  const defaultRedColor = "#EE3239";
  const grayColor = "#7A7878";
  const meetTitles = document.querySelectorAll(".meat-titles");
  const mobileTitles = document.querySelectorAll(".mobile_meat_title");

  mobileTitles.forEach((title) => {
    title.addEventListener("touchstart", function () {
      mobileTitles.forEach((titles) => {
        titles.classList.remove("active-mobile-meat-type");
      });

      const newSrc = this.getAttribute("data-img-src");

      mobileMeatSectionBanner.src = newSrc;

      meetTitles.forEach((title) => {
        title.classList.remove("active-mobile-line");
        title.style.color = grayColor;
      });

      title.classList.add("active-mobile-meat-type");
      const selectedTitle = this.querySelector(".meat-titles");
      selectedTitle.classList.add("active-mobile-line");
      selectedTitle.style.color = defaultRedColor;

      document
        .querySelectorAll(".line")
        .forEach((ln) => (ln.style.backgroundColor = grayColor));

      const line = this.querySelector(".line");
      if (line) {
        line.style.backgroundColor = defaultRedColor;
      }
    });
  });

  document.querySelectorAll(".meet-option").forEach((option) => {
    option.addEventListener("mouseenter", function () {
      const newSrc = this.getAttribute("data-img-src");
      const meatType = this.getAttribute("data-meat-type");
      meatImage.src = newSrc;
      meatImage.className = `w-full lg:pl-[21rem] px-10 rounded-full h-full meat-section-image ${meatType}`;

      meetTitles.forEach((title) => {
        if (title) {
          title.classList.remove(defaultTextClass);
          title.style.color = grayColor;
        }
      });

      const title = this.querySelector(".meat-titles");
      title.classList.add(defaultTextClass);
      title.style.color = defaultRedColor;

      const indicator = this.querySelector(".indicator");
      const line = this.querySelector(".line");

      indicator.style.borderColor = defaultRedColor;
      line.style.backgroundColor = defaultRedColor;
    });

    option.addEventListener("mouseleave", function () {
      meatImage.src = defaultImageSrc;
      meatImage.className = `w-full lg:pl-[21rem] px-10 rounded-full h-full meat-section-image meat`;

      meetTitles.forEach((title) => {
        title.classList.remove(defaultTextClass);
        title.style.color = grayColor;
      });

      document.querySelector(".meet").classList.add(defaultTextClass);
      document.querySelector(".meet").style.color = defaultRedColor;

      document
        .querySelectorAll(".indicator")
        .forEach((ind) => (ind.style.borderColor = grayColor));

      document
        .querySelectorAll(".line")
        .forEach((ln) => (ln.style.backgroundColor = grayColor));
    });
  });

  document
    .querySelector(".meet_section_info")
    .addEventListener("mouseleave", function () {
      meatImage.src = defaultImageSrc;
      meatImage.className = `w-full lg:pl-[21rem] px-10 rounded-full h-full meat-section-image meat`;

      meetTitles.forEach((title) => {
        title.classList.remove(defaultTextClass);
        title.style.color = grayColor;
      });
      document.querySelector(".meet").classList.add(defaultTextClass);
      document.querySelector(".meet").style.color = defaultRedColor;

      document
        .querySelectorAll(".indicator")
        .forEach((ind) => (ind.style.borderColor = grayColor));
      document
        .querySelectorAll(".line")
        .forEach((ln) => (ln.style.backgroundColor = grayColor));
    });
});
